<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VEO 3 Prompt Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1f2029;
            color: #E0E0E0;
        }
        .card {
            background-color: #2c2d3a;
            border: 1px solid #393a47;
        }
        .btn-primary {
            background-color: #8b5cf6;
            color: white;
            transition: background-color 0.2s;
        }
        .btn-primary:hover {
            background-color: #7c3aed;
        }
        .btn-secondary {
            background-color: #4a4b57;
            color: #d1d5db;
            transition: background-color 0.2s;
        }
        .btn-secondary:hover {
            background-color: #5a5b67;
        }
        .btn-active {
            background-color: #8b5cf6;
            color: white;
        }
        .btn-inactive {
            background-color: #393a47;
            color: #9ca3af;
        }
        .btn-copy {
            background-color: #14b8a6;
            color: white;
        }
        .btn-copy:hover {
             background-color: #0d9488;
        }
        .btn-gemini {
            background-color: #3b82f6;
            color: white;
        }
        .btn-gemini:hover {
            background-color: #2563eb;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .accordion-button svg.arrow {
            transition: transform 0.3s ease;
        }
        .accordion-button.active svg.arrow {
            transform: rotate(180deg);
        }
        .form-input, .form-select {
            background-color: #393a47;
            border: 1px solid #4a4b57;
            color: #f0f0f0;
        }
        .form-input:focus, .form-select:focus {
            border-color: #8b5cf6;
            --tw-ring-color: #8b5cf6;
        }
        .form-select option {
            background-color: #393a47;
            color: #f0f0f0;
        }
        .loader {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #8b5cf6;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto max-w-lg p-4 sm:p-6">
        
        <!-- Mode Adegan -->
        <div class="card p-4 rounded-xl mb-6">
            <h2 class="text-lg font-semibold text-center mb-3">Mode Adegan</h2>
            <div class="grid grid-cols-2 gap-3">
                <button id="mode-text-btn" class="mode-btn btn-active font-semibold py-2 px-4 rounded-lg">Mode Teks</button>
                <button id="mode-image-btn" class="mode-btn btn-inactive font-semibold py-2 px-4 rounded-lg">Analisis Gambar</button>
            </div>
        </div>

        <!-- Konten Mode -->
        <div id="mode-content">
            <!-- Mode Analisis Gambar -->
            <div id="image-analysis-section" class="hidden">
                 <div class="card p-4 rounded-xl mb-6">
                    <h2 class="text-lg font-semibold text-center mb-3">Deskripsikan Gambar (1:1)</h2>
                    <div class="space-y-4">
                        <div>
                            <label for="image-upload-subject" class="btn-secondary w-full text-center block py-2 px-4 rounded-lg cursor-pointer">Unggah Objek</label>
                            <input type="file" id="image-upload-subject" class="hidden" accept="image/*" data-type="subject">
                            <span id="file-name-subject" class="text-xs text-gray-400 mt-2 block text-center"></span>
                            <button id="gemini-btn-subject" class="btn-primary w-full mt-2 py-2 rounded-lg" disabled>Deskripsikan Objek</button>
                        </div>
                        <div>
                            <label for="image-upload-setting" class="btn-secondary w-full text-center block py-2 px-4 rounded-lg cursor-pointer">Unggah Tempat</label>
                            <input type="file" id="image-upload-setting" class="hidden" accept="image/*" data-type="setting">
                            <span id="file-name-setting" class="text-xs text-gray-400 mt-2 block text-center"></span>
                             <button id="gemini-btn-setting" class="btn-primary w-full mt-2 py-2 rounded-lg" disabled>Deskripsikan Tempat</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mode Teks Manual -->
            <div id="manual-input-section">
                <div class="card p-4 rounded-xl mb-6">
                    <h2 class="text-lg font-semibold text-center mb-3">Isi Manual</h2>
                    <div id="accordion-container" class="space-y-2">
                        <!-- Accordion items will be generated here -->
                    </div>
                     <button id="gemini-surprise-btn" class="btn-primary w-full mt-4 py-3 rounded-lg font-bold flex items-center justify-center gap-2">
                        <span id="gemini-surprise-text">Generate Pilihan</span>
                        <div id="gemini-surprise-loader" class="loader hidden"></div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Hasil Prompt Section -->
        <div class="space-y-6">
            <!-- Prompt Indonesia -->
            <div class="card p-4 rounded-xl">
                <h2 class="text-xl font-bold mb-3">Prompt Indonesia</h2>
                <textarea id="output-id" rows="4" class="form-input w-full p-3 rounded-lg text-base" readonly placeholder="Hasil prompt dalam Bahasa Indonesia..."></textarea>
                <div class="mt-3 grid grid-cols-2 gap-3">
                    <button class="btn-gemini font-semibold py-2 px-5 rounded-lg">Buka Gemini</button>
                    <button data-target="output-id" class="copy-btn font-semibold py-2 px-5 rounded-lg">Salin</button>
                </div>
                <div data-feedback-for="output-id" class="copy-feedback text-center text-green-400 mt-2 h-5 text-sm"></div>
            </div>
            <!-- Prompt English -->
            <div class="card p-4 rounded-xl">
                <h2 class="text-xl font-bold mb-3">Prompt English</h2>
                <textarea id="output-en" rows="4" class="form-input w-full p-3 rounded-lg text-base" readonly placeholder="Hasil terjemahan dalam Bahasa Inggris..."></textarea>
                <div class="mt-3 grid grid-cols-2 gap-3">
                     <button class="btn-gemini font-semibold py-2 px-5 rounded-lg">Buka Gemini</button>
                     <button data-target="output-en" class="copy-btn font-semibold py-2 px-5 rounded-lg">Salin</button>
                </div>
                 <div data-feedback-for="output-en" class="copy-feedback text-center text-green-400 mt-2 h-5 text-sm"></div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Data and DOM elements setup
            const accordionData = [
                { id: 'subject', title: 'Aktor Utama yang Terjadi', placeholder: 'Contoh: seekor naga emas raksasa' },
                { id: 'action', title: 'Gerakan (Aksi)', placeholder: 'Contoh: terbang di atas pegunungan' },
                { id: 'setting', title: 'Tempat (Latar Belakang)', placeholder: 'Contoh: kerajaan fantasi saat senja' },
                { id: 'style', title: 'Gaya Visual', placeholder: 'Contoh: sinematik, fotorealistis' },
                { id: 'shot', title: 'Jenis Sudut Kamera', placeholder: 'Contoh: wide shot, aerial view' },
                { id: 'lighting', title: 'Tipe Pencahayaan', placeholder: 'Contoh: golden hour, dramatis' },
                { id: 'quality', title: 'Kualitas yang Diharapkan', placeholder: 'Contoh: sangat detail, 8K' },
                { id: 'negative_prompt', title: 'Hal yang Dihilangkan', placeholder: 'Contoh: buram, kualitas rendah' }
            ];
            const dropdownOptions = {
                style: ['Fotorealistis', 'Sinematik', 'Gaya Anime 90-an', 'Gaya Studio Ghibli', 'Lukisan cat air', 'Seni Piksel (Pixel Art)', 'Model 3D', '3D Animation (Gaya Pixar)', 'Vaporwave', 'Cyberpunk', 'Steampunk', 'Fantasi Epik', 'Film Noir', 'Dokumenter Alam', 'Stop Motion', 'Claymation', 'Gaya Wes Anderson', 'Sketsa Hitam Putih', 'Gaya Komik', 'Seni Digital', 'Surealisme', 'Minimalis', 'Gothic'],
                shot: ['Wide Shot', 'Long Shot', 'Medium Shot', 'Close-up', 'Extreme Close-up', 'Aerial View', 'Drone Shot', 'Tracking Shot', 'Dolly Zoom', 'Point of View (POV)', 'First-Person View (FPV)', 'Over-the-Shoulder Shot', 'Dutch Angle', 'Handheld', 'Worm\'s-eye View', 'Bird\'s-eye View', 'Crane Shot', 'Zoom In/Out', 'Slow Motion', 'Time-lapse'],
                lighting: ['Golden Hour', 'Blue Hour', 'Pencahayaan Neon', 'Rembrandt Lighting', 'Cahaya Terang Siang Hari', 'Chiaroscuro (Dramatis)', 'Cahaya Bulan Purnama', 'Siluet', 'Pencahayaan Studio', 'Cahaya Lilin', 'Cahaya Api Unggun', 'Cahaya Bawah Air', 'Backlighting', 'High-key Lighting', 'Low-key Lighting', 'Cahaya Lembayung (Twilight)', 'Pencahayaan Volumetrik', 'Lens Flare'],
                quality: ['Sangat Detail (Hyperdetailed)', 'Resolusi 4K', 'Resolusi 8K', 'Render Unreal Engine', 'Render Octane', 'Fokus Tajam (Sharp Focus)', 'Bokeh', 'Grain Film', 'Lensa Anamorphic', 'Gradasi Warna Profesional', 'Tekstur Realistis', 'Makro (Macro)', 'Ultra-Wide Angle', 'Tilt-Shift', 'Sangat Jernih (Crystal Clear)', 'Gaya Film Vintage', 'Warna Cerah (Vivid Colors)', 'Matte Finish', 'Glossy Finish'],
                negative_prompt: ['kualitas buruk', 'buram', 'deformasi', 'teks', 'watermark', 'tangan jelek', 'gambar kartun', 'render jelek', 'noise', 'terlalu jenuh']
            };
            const accordionContainer = document.getElementById('accordion-container');
            const outputIdTextarea = document.getElementById('output-id');
            const outputEnTextarea = document.getElementById('output-en');
            const geminiSurpriseBtn = document.getElementById('gemini-surprise-btn');
            const geminiSurpriseText = document.getElementById('gemini-surprise-text');
            const geminiSurpriseLoader = document.getElementById('gemini-surprise-loader');
            const allInputs = [];
            let translationTimeout;
            let uploadedFiles = { subject: null, setting: null };

            // Function to generate the final prompt text
            function updatePrompt() {
                const positiveParts = allInputs.filter(input => input.dataset.type === 'positive' && input.value.trim()).map(input => input.value.trim());
                const negativeInput = allInputs.find(input => input.dataset.type === 'negative');
                let negativePart = negativeInput ? negativeInput.value.trim() : '';
                let promptInId = positiveParts.join(', ');
                if (negativePart) promptInId += ` --no ${negativePart}`;
                outputIdTextarea.value = promptInId;
                clearTimeout(translationTimeout);
                if (promptInId.trim()) {
                    translationTimeout = setTimeout(() => translateAndDisplay(promptInId), 500);
                } else {
                    outputEnTextarea.value = '';
                }
            }
            
            // Translate and display
            async function translateAndDisplay(textToTranslate) {
                outputEnTextarea.value = 'Menerjemahkan...';
                const promptToGemini = `Translate the following Indonesian video prompt to English. Keep the structure, including any "--no" parts, intact. Text: "${textToTranslate}"`;
                 try {
                    const apiKey = ""; 
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ contents: [{ parts: [{ text: promptToGemini }] }] }) });
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    const result = await response.json();
                    if (result.candidates && result.candidates[0].content.parts[0].text) {
                        outputEnTextarea.value = result.candidates[0].content.parts[0].text;
                    } else { outputEnTextarea.value = 'Gagal menerjemahkan.'; }
                } catch (error) { console.error("Translation error:", error); outputEnTextarea.value = 'Error saat menerjemahkan.'; }
            }

            // Dynamically create accordion items
            accordionData.forEach((item) => {
                const accordionItem = document.createElement('div');
                accordionItem.className = 'card rounded-lg overflow-hidden';
                let dropdownHTML = dropdownOptions[item.id] ? `<select class="form-select dropdown-menu w-full p-2 rounded-md mt-2 text-sm" data-target="${item.id}"><option value="">-- Pilih Opsi Cepat --</option>${dropdownOptions[item.id].map(opt => `<option value="${opt}">${opt}</option>`).join('')}</select>` : '';
                accordionItem.innerHTML = `<button class="accordion-button w-full flex justify-between items-center p-3 text-left font-semibold"><span class="flex items-center gap-3">${item.title}</span><svg class="arrow w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg></button><div class="accordion-content px-3"><div class="pb-3"><input type="text" id="${item.id}" data-type="${item.id === 'negative_prompt' ? 'positive' : 'positive'}" class="form-input w-full p-2 rounded-md text-sm" placeholder="${item.placeholder}">${dropdownHTML}</div></div>`;
                accordionContainer.appendChild(accordionItem);
                allInputs.push(document.getElementById(item.id));
            });
            
            // Add all event listeners
            allInputs.forEach(input => input.addEventListener('input', updatePrompt));
            document.querySelectorAll('.accordion-button').forEach(button => button.addEventListener('click', (e) => { const content = e.currentTarget.nextElementSibling; e.currentTarget.classList.toggle('active'); content.style.maxHeight = content.style.maxHeight ? null : content.scrollHeight + "px"; }));
            
            document.querySelectorAll('.dropdown-menu').forEach(dropdown => dropdown.addEventListener('change', function() { const selectedValue = this.value; if (!selectedValue) return; const targetInput = document.getElementById(this.dataset.target); targetInput.value = targetInput.value.trim() ? `${targetInput.value.trim()}, ${selectedValue}` : selectedValue; updatePrompt(); this.selectedIndex = 0; }));
            
            document.querySelectorAll('.copy-btn').forEach(button => button.addEventListener('click', function() { const targetId = this.dataset.target; const textarea = document.getElementById(targetId); if (!textarea.value) return; navigator.clipboard.writeText(textarea.value).then(() => { const feedbackEl = document.querySelector(`[data-feedback-for="${targetId}"]`); const originalText = this.textContent; feedbackEl.textContent = 'Prompt berhasil disalin!'; this.textContent = 'Disalin!'; setTimeout(() => { feedbackEl.textContent = ''; this.textContent = originalText; }, 2000); }); }));
            
            // Reset Button
            document.getElementById('reset-btn')?.addEventListener('click', () => { 
                allInputs.forEach(input => input.value = ''); 
                updatePrompt(); 
                ['subject', 'setting'].forEach(type => {
                    document.getElementById(`file-name-${type}`).textContent = '';
                    uploadedFiles[type] = null;
                    document.getElementById(`gemini-btn-${type}`).disabled = true;
                });
            });

            // Mode Toggle Logic
            const modeTextBtn = document.getElementById('mode-text-btn');
            const modeImageBtn = document.getElementById('mode-image-btn');
            const manualSection = document.getElementById('manual-input-section');
            const imageSection = document.getElementById('image-analysis-section');
            
            modeTextBtn.addEventListener('click', () => {
                modeTextBtn.classList.replace('btn-inactive', 'btn-active');
                modeImageBtn.classList.replace('btn-active', 'btn-inactive');
                manualSection.classList.remove('hidden');
                imageSection.classList.add('hidden');
            });
            modeImageBtn.addEventListener('click', () => {
                modeImageBtn.classList.replace('btn-inactive', 'btn-active');
                modeTextBtn.classList.replace('btn-active', 'btn-inactive');
                imageSection.classList.remove('hidden');
                manualSection.classList.add('hidden');
            });

            // Generic Gemini Image Description Logic
            async function describeImageWithGemini(type) {
                const file = uploadedFiles[type];
                if (!file) return;
                const button = document.getElementById(`gemini-btn-${type}`);
                button.innerHTML = `<div class="loader mx-auto"></div>`;
                button.disabled = true;

                const reader = new FileReader();
                reader.onloadend = async () => {
                    const base64Data = reader.result.split(',')[1];
                    const promptToGemini = type === 'subject' 
                        ? "Describe the main object or character in this image in a concise phrase suitable for a video prompt's 'subject' field. Focus on key visual attributes. Respond in Indonesian."
                        : "Describe the location or setting in this image in a concise phrase for a video prompt's 'setting' field. Focus on the environment and atmosphere. Respond in Indonesian.";
                    const payload = { contents: [{ role: "user", parts: [{ text: promptToGemini }, { inlineData: { mimeType: file.type, data: base64Data } }] }] };
                    try {
                        const apiKey = ""; const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                        const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                        const result = await response.json();
                        if (result.candidates && result.candidates[0].content.parts[0].text) {
                            document.getElementById(type).value = result.candidates[0].content.parts[0].text;
                            updatePrompt();
                            modeTextBtn.click(); // Switch back to text mode to see the result
                        } else { throw new Error("No valid description received."); }
                    } catch (error) { console.error(`Error calling Gemini for ${type}:`, error); alert(`Gagal menganalisis gambar.`);
                    } finally { button.innerHTML = type === 'subject' ? 'Deskripsikan Objek' : 'Deskripsikan Tempat'; }
                };
                reader.readAsDataURL(file);
            }

            // Event listeners for image uploads
            ['subject', 'setting'].forEach(type => {
                document.getElementById(`image-upload-${type}`).addEventListener('change', (e) => {
                    if (e.target.files && e.target.files[0]) {
                        uploadedFiles[type] = e.target.files[0];
                        document.getElementById(`file-name-${type}`).textContent = `File: ${uploadedFiles[type].name}`;
                        document.getElementById(`gemini-btn-${type}`).disabled = false;
                    }
                });
                document.getElementById(`gemini-btn-${type}`).addEventListener('click', () => describeImageWithGemini(type));
            });
            
            // Gemini Surprise Feature Logic
            geminiSurpriseBtn.addEventListener('click', async () => {
                geminiSurpriseBtn.disabled = true; geminiSurpriseText.textContent = ''; geminiSurpriseLoader.classList.remove('hidden');
                const promptToGemini = `You are a creative assistant for a text-to-video AI. Generate a complete, highly creative, visually stunning, and unexpected video prompt idea. Provide the output as a single JSON object with these exact keys: "subject", "action", "setting", "style", "shot", "lighting", "quality". All values must be in Indonesian.`;
                const payload = { contents: [{ role: "user", parts: [{ text: promptToGemini }] }], generationConfig: { responseMimeType: "application/json", responseSchema: { type: "OBJECT", properties: { subject: { type: "STRING" }, action: { type: "STRING" }, setting: { type: "STRING" }, style: { type: "STRING" }, shot: { type: "STRING" }, lighting: { type: "STRING" }, quality: { type: "STRING" } } } } };
                try {
                    const apiKey = ""; const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0) {
                        const idea = JSON.parse(result.candidates[0].content.parts[0].text);
                        for (const key in idea) { const input = document.getElementById(key); if (input) input.value = idea[key]; }
                        updatePrompt();
                    } else { throw new Error("No content received from API."); }
                } catch (error) { console.error("Error calling Gemini API:", error); alert("Gagal mendapatkan ide kejutan. Silakan coba lagi.");
                } finally { geminiSurpriseBtn.disabled = false; geminiSurpriseText.textContent = 'Generate Pilihan'; geminiSurpriseLoader.classList.add('hidden'); }
            });
        });
    </script>

</body>
</html>
